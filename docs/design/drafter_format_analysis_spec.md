# ドラフト作成プロセス強化 - 機能仕様書

## 概要

ドラフト作成時に、申請フォーマットに加えて募集要項も取得し、ダウンロードしたファイルの内容をGemini 3.0 Proで事前解析してからドラフトを作成する機能。

---

## 機能詳細

### 1. 募集要項の自動取得

**対象キーワード**:
- 募集要項、公募要領、応募要項、交付要綱、実施要領
- 募集案内、ガイドライン、公募要項

**動作**: 助成金ページをスクレイピングする際、上記キーワードにマッチするファイルリンクも検出してダウンロードします。

---

### 2. 申請フォーマット解析

**解析対象ファイル形式**:
- PDF（PyMuPDF使用）
- Word（.doc, .docx - python-docx使用）
- Excel（.xls, .xlsx - openpyxl使用）
- テキスト（.txt）

**抽出対象**:
1. 質問項目一覧（タイトルと説明）
2. 文字数制限
3. 記入例・サンプル
4. 必須/オプション項目の区別
5. 審査評価ポイント
6. 必要提出書類リスト

---

### 3. ドラフト作成フロー

```
Step 1: フォーマット検索とダウンロード
  └─ 申請フォーマット + 募集要項を取得

Step 2: ファイル解析（新規）
  └─ Gemini 3.0 Proで質問項目・評価ポイントを抽出

Step 3: ドラフト生成
  └─ 解析結果を反映して各質問項目への回答を作成
```

---

## 依存パッケージ

```bash
pip install PyMuPDF python-docx openpyxl
```

> **注意**: 未インストールの場合も動作しますが、該当形式のファイル解析がスキップされます。

---

## 制限事項

- 画像ベースPDF（スキャン文書等）はテキスト抽出不可
- 解析対象は最大5ファイル、各ファイル最大8000文字
- `.doc`形式（古いWord）はpython-docxで読み取れない場合あり
